syntax = "proto3";

package end_device.v1;

import "google/protobuf/timestamp.proto";

// EndDevice represents a device registered in the system.
// Devices are scoped to organizations for multi-tenancy.
message EndDevice {
  // Server-generated unique identifier (UUID format)
  string device_id = 1;

  // Organization that owns this device
  string organization_id = 2;

  // Reference to the EndDeviceDefinition
  string definition_id = 3;

  // Human-readable name for the device
  string name = 4;

  // When the device was created
  google.protobuf.Timestamp created_at = 5;

  // When the device was last updated
  google.protobuf.Timestamp updated_at = 6;

  // Workspace this device belongs to
  string workspace_id = 7;

  // Gateway this device is connected to
  string gateway_id = 8;
}

// Request to create a new device
// Device ID is generated server-side
message CreateEndDeviceRequest {
  // Organization that will own this device
  string organization_id = 1;

  // Reference to the EndDeviceDefinition (required)
  string definition_id = 2;

  // Human-readable name for the device
  string name = 3;

  // Workspace this device belongs to
  string workspace_id = 4;

  // Gateway this device connects to
  string gateway_id = 5;
}

// Response containing the newly created device
message CreateEndDeviceResponse {
  // The created device with server-generated ID and timestamps
  EndDevice end_device = 1;
}

// Request to get a device by ID
message GetEndDeviceRequest {
  // Unique identifier of the device to retrieve
  string device_id = 1;

  // Organization ID owning the device
  string organization_id = 2;

  // Workspace ID containing the device
  string workspace_id = 3;
}

// Response containing the requested device
message GetEndDeviceResponse {
  // The requested device
  EndDevice end_device = 1;
}

// Request to get all devices for a workspace
message GetWorkspaceEndDevicesRequest {
  // Organization ID owning the workspace
  string organization_id = 1;

  // Workspace ID to filter devices by
  string workspace_id = 2;
}

// Response containing devices for the workspace
message GetWorkspaceEndDevicesResponse {
  // List of devices belonging to the workspace
  repeated EndDevice end_devices = 1;
}

// Request to get all devices connected to a gateway
message GetGatewayEndDevicesRequest {
  // Organization ID owning the gateway
  string organization_id = 1;

  // Gateway ID to filter devices by
  string gateway_id = 2;
}

// Response containing devices connected to the gateway
message GetGatewayEndDevicesResponse {
  // List of devices connected to the gateway
  repeated EndDevice end_devices = 1;
}

// Service for managing device lifecycle
service EndDeviceService {
  // Register a new device
  rpc CreateEndDevice(CreateEndDeviceRequest) returns (CreateEndDeviceResponse);

  // Retrieve a device by its ID
  rpc GetEndDevice(GetEndDeviceRequest) returns (GetEndDeviceResponse);

  // Get all devices for a workspace
  rpc GetWorkspaceEndDevices(GetWorkspaceEndDevicesRequest) returns (GetWorkspaceEndDevicesResponse);

  // Get all devices connected to a gateway
  rpc GetGatewayEndDevices(GetGatewayEndDevicesRequest) returns (GetGatewayEndDevicesResponse);
}
